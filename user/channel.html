<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Nvim documentation: channel</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet">
    <link href="/css/normalize.min.css" rel="stylesheet">
    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
  </head>
  <body>
    <header class="container">
      <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
          <a href="/" class="navbar-brand">
            <svg xmlns="http://www.w3.org/2000/svg" style="height: 2.5em" viewBox="0 0 742 214">
              <defs>
                <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="a">
                  <stop stop-color="#16B0ED" stop-opacity=".8" offset="0%" />
                  <stop stop-color="#0F59B2" stop-opacity=".837" offset="100%" />
                </linearGradient>
                <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="b">
                  <stop stop-color="#7DB643" offset="0%" />
                  <stop stop-color="#367533" offset="100%" />
                </linearGradient>
                <linearGradient x1="50%" y1="0%" x2="50%" y2="100%" id="c">
                  <stop stop-color="#88C649" stop-opacity=".8" offset="0%" />
                  <stop stop-color="#439240" stop-opacity=".84" offset="100%" />
                </linearGradient>
              </defs>
              <g fill="none" fill-rule="evenodd">
                <path
                  d="M.027 45.459L45.224-.173v212.171L.027 166.894V45.459z"
                  fill="url(#a)"
                  transform="translate(1 1)"
                />
                <path
                  d="M129.337 45.89L175.152-.149l-.928 212.146-45.197-45.104.31-121.005z"
                  fill="url(#b)"
                  transform="matrix(-1 0 0 1 305 1)"
                />
                <path
                  d="M45.194-.137L162.7 179.173l-32.882 32.881L12.25 33.141 45.194-.137z"
                  fill="url(#c)"
                  transform="translate(1 1)"
                />
                <path
                  d="M46.234 84.032l-.063 7.063-36.28-53.563 3.36-3.422 32.983 49.922z"
                  fill-opacity=".13"
                  fill="#000"
                />
                <g fill="#444">
                  <path
                    d="M227 154V64.44h4.655c1.55 0 2.445.75 2.685 2.25l.806 13.502c4.058-5.16 8.786-9.316 14.188-12.466 5.4-3.15 11.413-4.726 18.037-4.726 4.893 0 9.205.781 12.935 2.34 3.729 1.561 6.817 3.811 9.264 6.751 2.448 2.942 4.297 6.48 5.55 10.621 1.253 4.14 1.88 8.821 1.88 14.042V154h-8.504V96.754c0-8.402-1.91-14.987-5.729-19.757-3.82-4.771-9.667-7.156-17.544-7.156-5.851 0-11.28 1.516-16.292 4.545-5.013 3.032-9.489 7.187-13.427 12.467V154H227zM350.624 63c5.066 0 9.755.868 14.069 2.605 4.312 1.738 8.052 4.268 11.219 7.592s5.638 7.412 7.419 12.264C385.11 90.313 386 95.883 386 102.17c0 1.318-.195 2.216-.588 2.696-.393.48-1.01.719-1.851.719h-64.966v1.70c0 6.708.784 12.609 2.353 17.7 1.567 5.09 3.8 9.357 6.695 12.802 2.895 3.445 6.393 6.034 10.495 7.771 4.1 1.738 8.686 2.606 13.752 2.606 4.524 0 8.446-.494 11.762-1.483 3.317-.988 6.108-2.097 8.37-3.324 2.261-1.227 4.056-2.336 5.383-3.324 1.326-.988 2.292-1.482 2.895-1.482.784 0 1.388.3 1.81.898l2.352 2.875c-1.448 1.797-3.362 3.475-5.745 5.031-2.383 1.558-5.038 2.891-7.962 3.998-2.926 1.109-6.062 1.991-9.41 2.65a52.21 52.21 0 01-10.088.989c-6.152 0-11.762-1.064-16.828-3.19-5.067-2.125-9.415-5.225-13.043-9.298-3.63-4.074-6.435-9.06-8.415-14.96C310.99 121.655 310 114.9 310 107.294c0-6.408.92-12.323 2.76-17.744 1.84-5.421 4.493-10.093 7.961-14.016 3.467-3.922 7.72-6.991 12.758-9.209C338.513 64.11 344.229 63 350.624 63zm.573 6c-4.696 0-8.904.702-12.623 2.105-3.721 1.404-6.936 3.421-9.65 6.053-2.713 2.631-4.908 5.79-6.586 9.474S319.55 94.439 319 99h60c0-4.679-.672-8.874-2.013-12.588-1.343-3.712-3.232-6.856-5.67-9.43-2.44-2.571-5.367-4.545-8.782-5.92-3.413-1.374-7.192-2.062-11.338-2.062zM435.546 63c6.526 0 12.368 1.093 17.524 3.28 5.154 2.186 9.5 5.286 13.04 9.298 3.538 4.013 6.238 8.85 8.099 14.51 1.861 5.66 2.791 11.994 2.791 19.002 0 7.008-.932 13.327-2.791 18.957-1.861 5.631-4.561 10.452-8.099 14.465-3.54 4.012-7.886 7.097-13.04 9.254-5.156 2.156-10.998 3.234-17.524 3.234-6.529 0-12.369-1.078-17.525-3.234-5.155-2.157-9.517-5.242-13.085-9.254-3.57-4.013-6.285-8.836-8.145-14.465-1.861-5.63-2.791-11.95-2.791-18.957 0-7.008.93-13.342 2.791-19.002 1.861-5.66 4.576-10.496 8.145-14.51 3.568-4.012 7.93-7.112 13.085-9.299C423.177 64.094 429.017 63 435.546 63zm-.501 86c5.341 0 10.006-.918 13.997-2.757 3.99-1.838 7.32-4.474 9.992-7.909 2.67-3.435 4.664-7.576 5.986-12.428 1.317-4.85 1.98-10.288 1.98-16.316 0-5.965-.66-11.389-1.98-16.27-1.322-4.88-3.316-9.053-5.986-12.519-2.67-3.463-6-6.13-9.992-7.999-3.991-1.867-8.657-2.802-13.997-2.802s-10.008.935-13.997 2.802c-3.991 1.87-7.322 4.536-9.992 8-2.671 3.465-4.68 7.637-6.03 12.518-1.35 4.881-2.026 10.305-2.026 16.27 0 6.026.675 11.465 2.025 16.316 1.35 4.852 3.36 8.993 6.031 12.428 2.67 3.435 6 6.07 9.992 7.91 3.99 1.838 8.656 2.756 13.997 2.756z"
                    fill="currentColor"
                  />
                  <path
                    d="M530.57 152h-20.05L474 60h18.35c1.61 0 2.967.39 4.072 1.166 1.103.778 1.865 1.763 2.283 2.959l17.722 49.138a92.762 92.762 0 012.551 8.429c.686 2.751 1.298 5.5 1.835 8.25.537-2.75 1.148-5.499 1.835-8.25a77.713 77.713 0 012.64-8.429l18.171-49.138c.417-1.196 1.164-2.181 2.238-2.96 1.074-.776 2.356-1.165 3.849-1.165H567l-36.43 92zM572 61h23v92h-23zM610 153V60.443h13.624c2.887 0 4.78 1.354 5.682 4.06l1.443 6.856a52.7 52.7 0 015.097-4.962 32.732 32.732 0 015.683-3.879 30.731 30.731 0 016.496-2.57c2.314-.632 4.855-.948 7.624-.948 5.832 0 10.63 1.579 14.39 4.736 3.758 3.157 6.57 7.352 8.434 12.585 1.444-3.068 3.248-5.698 5.413-7.894 2.165-2.194 4.541-3.984 7.127-5.367a32.848 32.848 0 018.254-3.068 39.597 39.597 0 018.796-.992c5.111 0 9.653.783 13.622 2.345 3.97 1.565 7.307 3.849 10.014 6.857 2.706 3.007 4.766 6.675 6.18 11.005C739.29 83.537 740 88.5 740 94.092V153h-22.284V94.092c0-5.894-1.294-10.329-3.878-13.306-2.587-2.977-6.376-4.465-11.368-4.465-2.286 0-4.404.391-6.358 1.172a15.189 15.189 0 00-5.144 3.383c-1.473 1.474-2.631 3.324-3.474 5.548-.842 2.225-1.263 4.781-1.263 7.668V153h-22.37V94.092c0-6.194-1.249-10.704-3.744-13.532-2.497-2.825-6.18-4.24-11.051-4.24-3.19 0-6.18.798-8.976 2.391-2.799 1.593-5.399 3.775-7.804 6.54V153H610zM572 30h23v19h-23z"
                    fill="currentColor"
                    fill-opacity=".8"
                  />
                </g>
              </g>
            </svg>
          </a>
        </div>
      </nav>
    </header>

    <div class="container">
      <h1>Nvim documentation: channel</h1>
<A NAME="top"></A>
<A HREF="index.html">main help file</A>

<HR>
<PRE>

*<A NAME="channel.txt"></A><B>channel.txt</B>*    Nvim


		 NVIM REFERENCE MANUAL    by Thiago de Arruda



Nvim asynchronous IO					*<A NAME="channel"></A><B>channel</B>*

				      Type |<A HREF="various.html#gO">gO</A>| to see the table of contents.

==============================================================================

1. Introduction						    *<A NAME="channel-intro"></A><B>channel-intro</B>*

Channels are nvim's way of communicating with external processes.

There are several ways to open a <A HREF="#channel">channel</A>:

  1. Through stdin/stdout when `nvim` is started with `--headless`, and a <A HREF="starting.html#startup">startup</A>
     <A HREF="usr_41.html#script">script</A> or <A HREF="starting.html#--cmd">--cmd</A>  command opens the stdio <A HREF="#channel">channel</A> using |<A HREF="eval.html#stdioopen()">stdioopen()</A>|.

  2. Through stdin, stdout and stderr of a process spawned by |<A HREF="eval.html#jobstart()">jobstart()</A>|.

  3. Through the PTY master end of a PTY opened with
     `jobstart(..., {'pty': v:true})` or |<A HREF="eval.html#termopen()">termopen()</A>|.

  4. By connecting to a TCP/IP socket or named pipe with |<A HREF="eval.html#sockconnect()">sockconnect()</A>|.

  5. By another process connecting to a socket listened to by <A HREF="nvim.html#nvim">nvim</A>. This only
     supports <A HREF="api.html#RPC">RPC</A> channels, see |<A HREF="api.html#rpc-connecting">rpc-connecting</A>|.

Channels support multiple modes or protocols. In the most basic
mode of operation, raw bytes are read and written to the <A HREF="#channel">channel</A>.
The |<A HREF="api.html#RPC">RPC</A>| protocol, based on the <A HREF="api.html#msgpack-rpc">msgpack-rpc</A> standard, enables <A HREF="nvim.html#nvim">nvim</A> and the
process at the other end to send remote calls and <A HREF="autocmd.html#events">events</A> to each other.
The builtin |<A HREF="nvim_terminal_emulator.html#terminal-emulator">terminal-emulator</A>| is also implemented on top of PTY channels.


Channel Id						*<A NAME="channel-id"></A><B>channel-id</B>*

Each <A HREF="#channel">channel</A> is identified by an integer id, unique for the life of the
current Nvim session. Functions like |<A HREF="eval.html#stdioopen()">stdioopen()</A>| return <A HREF="#channel">channel</A> ids;
<A HREF="eval.html#functions">functions</A> like |<A HREF="eval.html#chansend()">chansend()</A>| consume <A HREF="#channel">channel</A> ids.

==============================================================================

2. Reading and <A HREF="editing.html#writing">writing</A> raw bytes			      *<A NAME="channel-bytes"></A><B>channel-bytes</B>*

Channels opened by Vimscript <A HREF="eval.html#functions">functions</A> operate with raw bytes by default. For
a <A HREF="job_control.html#job">job</A> <A HREF="#channel">channel</A> using <A HREF="api.html#RPC">RPC</A>, bytes can still be read over its stderr. Similarily,
only bytes can be written to Nvim's own stderr.


						*<A NAME="channel-callback"></A><B>channel-callback</B>*

on_stdout({chan-id}, {data}, {name})		*<A NAME="on_stdout"></A><B>on_stdout</B>* 

on_stderr({chan-id}, {data}, {name})		*<A NAME="on_stderr"></A><B>on_stderr</B>* 

on_stdin({chan-id}, {data}, {name})		*<A NAME="on_stdin"></A><B>on_stdin</B>* 

on_data({chan-id}, {data}, {name})		*<A NAME="on_data"></A><B>on_data</B>*
    Scripts can react to <A HREF="#channel">channel</A> activity (received data) via callback
    <A HREF="eval.html#functions">functions</A> assigned to the `on_stdout`, `on_stderr`, `on_stdin`, or
    `on_data` option keys. Callbacks should be fast: avoid potentially
    slow/expensive work.

<B><FONT color="#54A23D">    Parameters: </FONT></B>
      {chan-id}     Channel handle. |<A HREF="#channel-id">channel-id</A>|
      {data}	    Raw data (|readfile()|-style <A HREF="eval.html#list">list</A> of strings) read from
		    the <A HREF="#channel">channel</A>. EOF is a single-item <A HREF="eval.html#list">list</A>: `['']`. First and
		    last items may be partial lines! |<A HREF="#channel-lines">channel-lines</A>|
      {name}	    Stream name (string) like &quot;stdout&quot;, so the same function
		    can handle multiple streams. Event names depend on how the
		    <A HREF="#channel">channel</A> was opened and in what mode/protocol.


						*<A NAME="channel-buffered"></A><B>channel-buffered</B>*
    The callback is invoked immediately <A HREF="motion.html#as">as</A> data is available, where
    a single-item <A HREF="eval.html#list">list</A> `['']` indicates EOF (stream closed).  Alternatively
    set the `stdout_buffered`, `stderr_buffered`, `stdin_buffered`, or
    `data_buffered` option keys to invoke the callback only after all output
    was gathered and the stream was closed.

						*<A NAME="E5210"></A><B>E5210</B>*
    If a buffering mode is used without a callback, the data is saved in the
    stream {name} key of the <A HREF="options.html#options">options</A> <A HREF="eval.html#dict">dict</A>. It is an error if the key exists.


							      *<A NAME="channel-lines"></A><B>channel-lines</B>*
    Stream event handlers receive data <A HREF="motion.html#as">as</A> <A HREF="motion.html#it">it</A> becomes available from the OS,
    thus the first and last items in the {data} <A HREF="eval.html#list">list</A> may be partial lines.
    Empty <A HREF="eval.html#string">string</A> completes the previous partial line. Examples (not including
    the final `['']` emitted at EOF):
      - `foobar` may arrive <A HREF="motion.html#as">as</A> `['fo'], ['obar']` 
      - `foo\nbar` may arrive <A HREF="motion.html#as">as</A>
	   `['foo','bar']`
	or `['foo',''], ['bar']`
	or `['foo'], ['','bar']`
	or `['fo'], ['o','bar']`
    There are two ways to deal with this:
    1. To wait for the entire output, use |<A HREF="#channel-buffered">channel-buffered</A>| mode.
    2. To read line-by-line, use the following code:
<B>	let s:lines = ['']</B>
<B>	func! s:on_event(job_id, data, event) dict</B>
<B>	  let eof = (a:data == [''])</B>
<B>	  " Complete the previous line.</B>
<B>	  let s:lines[-1] .= a:data[0]</B>
<B>	  " Append (last item may be a partial line, until EOF).</B>
<B>	  call extend(s:lines, a:data[1:])</B>
<B>	endf</B>
 

If the callback <A HREF="eval.html#functions">functions</A> are |<A HREF="eval.html#Dictionary-function">Dictionary-function</A>|s, |<A HREF="eval.html#self">self</A>| refers to the
<A HREF="options.html#options">options</A> dictionary containing the callbacks. |<A HREF="eval.html#Partial">Partial</A>|<A HREF="change.html#s">s</A> can also be used <A HREF="motion.html#as">as</A>
callbacks.

Data can be sent to the <A HREF="#channel">channel</A> using the |<A HREF="eval.html#chansend()">chansend()</A>| function. Here is a
simple example, echoing some data through a cat-process:

<B>    function! s:OnEvent(id, data, event) dict</B>
<B>      let str = join(a:data, "\n")</B>
<B>      echomsg str</B>
<B>    endfunction</B>
<B>    let id = jobstart(['cat'], {'on_stdout': function('s:OnEvent') } )</B>
<B>    call chansend(id, "hello!")</B>
 

Here is a example of setting a buffer to the result of <A HREF="quickfix.html#grep">grep</A>, but only after
all data has been processed:

<B>    function! s:OnEvent(id, data, event) dict</B>
<B>      call nvim_buf_set_lines(2, 0, -1, v:true, a:data)</B>
<B>    endfunction</B>
<B>    let id = jobstart(['grep', '^[0-9]'], { 'on_stdout': function('s:OnEvent'),</B>
<B>					  \ 'stdout_buffered':v:true } )</B>

<B>    call chansend(id, "stuff\n10 PRINT \"NVIM\"\nxx")</B>
<B>    " no output is received, buffer is empty</B>

<B>    call chansend(id, "xx\n20 GOTO 10\nzz\n")</B>
<B>    call chanclose(id, 'stdin')</B>
<B>    " now buffer has result</B>
 
For additional examples with jobs, see |<A HREF="job_control.html#job-control">job-control</A>|.


							      *<A NAME="channel-pty"></A><B>channel-pty</B>*
Special <A HREF="change.html#case">case</A>: PTY channels opened with `jobstart(..., {'pty': v:true})` <A HREF="diff.html#do">do</A> not
preprocess ANSI <A HREF="intro.html#escape">escape</A> sequences, these will be sent raw to the callback.
However, change of PTY size can be signaled to the slave using |<A HREF="eval.html#jobresize()">jobresize()</A>|.
See also |<A HREF="nvim_terminal_emulator.html#terminal-emulator">terminal-emulator</A>|.

Terminal characteristics (termios) for |<A HREF="various.html#:terminal">:terminal</A>| and PTY channels are copied
from the host TTY, or if Nvim is |<A HREF="starting.html#--headless">--headless</A>| <A HREF="motion.html#it">it</A> uses default values:
<B>    :echo system('nvim --headless +"te stty -a" +"sleep 1" +"1,/^$/print" +q')</B>

==============================================================================

3. Communicating using <A HREF="api.html#msgpack-rpc">msgpack-rpc</A>			      *<A NAME="channel-rpc"></A><B>channel-rpc</B>*

When channels are opened with the `rpc` option set to true, the <A HREF="#channel">channel</A> can be
used for remote method calls in both directions, see |<A HREF="api.html#msgpack-rpc">msgpack-rpc</A>|. Note that
<A HREF="api.html#rpc">rpc</A> channels are implicitly trusted and the process at the other end can
invoke any |<A HREF="api.html#api">api</A>| function!

==============================================================================

4. Standard IO <A HREF="#channel">channel</A>					    *<A NAME="channel-stdio"></A><B>channel-stdio</B>*

Nvim uses stdin/stdout to interact with the user over the <A HREF="nvim_terminal_emulator.html#terminal">terminal</A> interface
(TUI). If Nvim is |<A HREF="starting.html#--headless">--headless</A>| the <A HREF="term.html#TUI">TUI</A> is not started and stdin/stdout can be
used <A HREF="motion.html#as">as</A> a <A HREF="#channel">channel</A>. See also |<A HREF="starting.html#--embed">--embed</A>|.

Call |<A HREF="eval.html#stdioopen()">stdioopen()</A>| during |<A HREF="starting.html#startup">startup</A>| to open the stdio channel <A HREF="motion.html#as">as</A> |<A HREF="#channel-id">channel-id</A>| 1.
Nvim's stderr is always available <A HREF="motion.html#as">as</A> |<A HREF="eval.html#v:stderr">v:stderr</A>|, a write-only bytes <A HREF="#channel">channel</A>.

Example:
<B>    func! OnEvent(id, data, event)</B>
<B>      if a:data == [""]</B>
<B>        quit</B>
<B>      end</B>
<B>      call chansend(a:id, map(a:data, {i,v -&gt; toupper(v)}))</B>
<B>    endfunc</B>
<B>    call stdioopen({'on_stdin': 'OnEvent'})</B>
 
Put this in `uppercase.vim` and run: 
<B>    nvim --headless --cmd "source uppercase.vim"</B>

==============================================================================

5. Using a prompt buffer				*<A NAME="prompt-buffer"></A><B>prompt-buffer</B>*

If you want to type input for the <A HREF="job_control.html#job">job</A> in a Vim <A HREF="windows.html#window">window</A> you have a few <A HREF="options.html#options">options</A>:
- Use a normal buffer and handle all possible commands yourself.
  This will be complicated, since there are so many possible commands.
- Use a <A HREF="nvim_terminal_emulator.html#terminal">terminal</A> <A HREF="windows.html#window">window</A>.  This works well if what you type goes directly to
  the <A HREF="job_control.html#job">job</A> and the <A HREF="job_control.html#job">job</A> output is directly displayed in the <A HREF="windows.html#window">window</A>.
  See |<A HREF="nvim_terminal_emulator.html#terminal">terminal</A>|.
- Use a <A HREF="windows.html#window">window</A> with a prompt buffer. This works well when entering a line for
  the <A HREF="job_control.html#job">job</A> in Vim while displaying (possibly filtered) output from the <A HREF="job_control.html#job">job</A>.

A prompt buffer is created by setting <A HREF="options.html#'buftype'">'buftype'</A> to &quot;prompt&quot;. You would
normally only <A HREF="diff.html#do">do</A> that in a newly created buffer.

The user can edit and enter one line of text at the very last line of the
buffer.  When pressing Enter in the prompt line the callback set with
|<A HREF="eval.html#prompt_setcallback()">prompt_setcallback()</A>| is invoked.  It would normally send the line to a <A HREF="job_control.html#job">job</A>.
Another callback would receive the output from the <A HREF="job_control.html#job">job</A> and display <A HREF="motion.html#it">it</A> in the
buffer, below the prompt (and above the next prompt).

Only the text in the last line, after the prompt, is editable. The rest of the
buffer is not modifiable with <A HREF="intro.html#Normal">Normal</A> mode commands.  It can be modified by
calling <A HREF="eval.html#functions">functions</A>, such <A HREF="motion.html#as">as</A> |<A HREF="eval.html#append()">append()</A>|.  Using other commands may mess up the
buffer.

After setting <A HREF="options.html#'buftype'">'buftype'</A> to &quot;prompt&quot; Vim does not automatically start <A HREF="insert.html#Insert">Insert</A>
mode, use `:startinsert` if you want to enter <A HREF="insert.html#Insert">Insert</A> mode, so that the user
can start typing a line.

The text of the prompt can be set with the |<A HREF="eval.html#prompt_setprompt()">prompt_setprompt()</A>| function. If
no prompt is set with |<A HREF="eval.html#prompt_setprompt()">prompt_setprompt()</A>|, &quot;<A HREF="motion.html#&#37;">&#37;</A> &quot; is used. You can get the
effective prompt text for a buffer, with |<A HREF="eval.html#prompt_getprompt()">prompt_getprompt()</A>|.

The user can go to <A HREF="intro.html#Normal">Normal</A> mode and navigate through the buffer.  This can be
useful to see older output or copy text.

Any command that starts <A HREF="insert.html#Insert">Insert</A> mode, such <A HREF="motion.html#as">as</A> &quot;<A HREF="insert.html#a">a</A>&quot;, &quot;<A HREF="insert.html#i">i</A>&quot;, &quot;<A HREF="insert.html#A">A</A>&quot; and &quot;<A HREF="insert.html#I">I</A>&quot;, will move
the cursor to the last line.  &quot;<A HREF="insert.html#A">A</A>&quot; will move to the end of the line, &quot;<A HREF="insert.html#I">I</A>&quot; to the
start of the line.

Here is an example for Unix.  It starts a shell in the background and prompts
for the next shell command.  Output from the shell is displayed above the
prompt.

<B>	" Function handling a line of text that has been typed.</B>
<B>	func TextEntered(text)</B>
<B>	  " Send the text to a shell with Enter appended.</B>
<B>	  call chansend(g:shell_job, [a:text, ''])</B>
<B>	endfunc</B>

<B>	" Function handling output from the shell: Added above the prompt.</B>
<B>	func GotOutput(channel, msg, name)</B>
<B>	  call append(line("$") - 1, a:msg)</B>
<B>	endfunc</B>

<B>	" Function handling the shell exit: close the window.</B>
<B>	func JobExit(job, status, event)</B>
<B>	  quit!</B>
<B>	endfunc</B>

<B>	" Start a shell in the background.</B>
<B>	let shell_job = jobstart(["/bin/sh"], #{</B>
<B>		\ on_stdout: function('GotOutput'),</B>
<B>		\ on_stderr: function('GotOutput'),</B>
<B>		\ on_exit: function('JobExit'),</B>
<B>		\ })</B>

<B>	new</B>
<B>	set buftype=prompt</B>
<B>	let buf = bufnr('')</B>
<B>	call prompt_setcallback(buf, function("TextEntered"))</B>
<B>	call prompt_setprompt(buf, "shell command: ")</B>

<B>	" start accepting shell commands</B>
<B>	startinsert</B>
 

<A HREF="#top">top</A> - <A HREF="index.html">main help file</A>
</PRE>
    </div>

    <footer>
      <div class="container">
        Generated Mon Jul 12 05:29:04 UTC 2021 from <a href="https://github.com/neovim/neovim/commit/eece0735fe3b4f70747644ebf5daf7320f441616"><code>eece073</code></a>.
      </div>
    </footer>
  </body>
</html>
